<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Add Progress Bars to Mapping Functions • purrrogress</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Add Progress Bars to Mapping Functions">
<meta property="og:description" content="Provides functions to easily add progress bars to 
    apply calls.">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">purrrogress</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/halpo/purrrogress">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="purrrogress" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#purrrogress" class="anchor"></a>purrrogress <img src="reference/figures/logo.svg" align="right" height="139">
</h1></div>
<!-- badges: start -->

<p>The goal of purrrogress is to add as simply as possible progress bars to <a href="http://purrr.tidyverse.org"><code>purrr</code></a> mapping functions.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of purrrogress from <a href="https://CRAN.R-project.org">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"purrrogress"</span>)</a></code></pre></div>
</div>
<div id="using" class="section level2">
<h2 class="hasAnchor">
<a href="#using" class="anchor"></a>Using</h2>
<p>Progress bars can be added to any map function with the <code><a href="reference/with_progress.html">with_progress()</a></code> function wrapped around the function to be mapped.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(purrrogress)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">## basic example code</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">fun &lt;-<span class="st"> </span><span class="cf">function</span>(...){</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">    <span class="co"># this does nothing but take time.</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">    <span class="kw"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span>(<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">    <span class="kw"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="kw">map</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="kw"><a href="reference/with_progress.html">with_progress</a></span>(fun)))</a></code></pre></div>
<p>This example doesn’t do much but illustrates the simplicity of purrrogress bars. The length of the progress bar is imputed from the variable passed to the map function as well as the title and label for the progress bar. No changes are needed to the function and all arguments are passed on as is.</p>
<div id="caveat" class="section level3">
<h3 class="hasAnchor">
<a href="#caveat" class="anchor"></a>Caveat</h3>
<p>The <code><a href="reference/with_progress.html">with_progress()</a></code> function can only impute the length if it is actually part of the map call. The following will not work.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># This will not work.</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">not_so_fun &lt;-<span class="st"> </span><span class="kw"><a href="reference/with_progress.html">with_progress</a></span>(fun)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="kw">map</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, not_so_fun))</a></code></pre></div>
<p>This could be made to work by specifying the length if known a priori.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># The fix</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">just_less_fun &lt;-<span class="st"> </span><span class="kw"><a href="reference/with_progress.html">with_progress</a></span>(fun, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="kw">map</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, just_less_fun))</a></code></pre></div>
</div>
<div id="directly" class="section level3">
<h3 class="hasAnchor">
<a href="#directly" class="anchor"></a>Directly</h3>
<p>The progress bars used by <code>purrrogress</code> are defined in a class system described in a later section. Progress bars can be created and manipulated directly through the <code><a href="reference/progress_bar.html">progress_bar()</a></code> function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">pb &lt;-<span class="st"> </span><span class="kw"><a href="reference/progress_bar.html">progress_bar</a></span>(<span class="dv">100</span>, <span class="st">"A Title"</span>, <span class="st">"An informative label"</span>, <span class="dt">type=</span><span class="st">"none"</span>)</a></code></pre></div>
<p>The type argument will determine what type of progress bar is created, windows, Tk, or none(used for testing and demonstration).</p>
</div>
</div>
</div>
<div id="customization" class="section level1">
<h1 class="hasAnchor">
<a href="#customization" class="anchor"></a>Customization</h1>
<p>The progress bar windows can be customized to display relevant information such as the number of elements completed, or the estimated time remaining. This can be accomplished through inserting <a href="https://glue.tidyverse.org/">glue</a> style keywords. These keywords are added by default:</p>
<ul>
<li>
<code>total</code> - the total number of elements.</li>
<li>
<code>current</code> - the current number of elements completed.</li>
<li>
<code>frac</code> - an alias for <code>"{current}/{total}"</code>, giving the nicely formatted fraction of completed elements.</li>
<li>
<code>percent</code> - the percent completed as a whole number percent.</li>
<li>
<code>elapsed.time</code> - The total time elapsed from the start to the completion of the last <code><a href="https://rdrr.io/r/stats/step.html">step()</a></code> or <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> call, typically the last element completion.</li>
<li>
<code>average.time</code> - The average time to complete each step.</li>
<li>
<code>estimated.total.time</code> - a naive estimate of the total time remaining. Taken as the <code>average.time * total</code>.</li>
<li>
<code>estimated.time.remaining</code> - Just what is says, <code>estimated.total.time - elapsed.time</code>.</li>
<li>
<code>etr</code> - alias for <code>estimated.time.remaining</code>
</li>
</ul>
<p>These keywords can be used in either the title or the label of progress bars to obtain more informative messages.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">pb &lt;-<span class="st"> </span><span class="kw"><a href="reference/progress_bar.html">progress_bar</a></span>( <span class="dv">100</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">                  , <span class="dt">title =</span> <span class="st">"Test progress bar ({etr})"</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                  , <span class="dt">label =</span> <span class="st">"{frac}({percent}) completed."</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">                  , <span class="dt">initial =</span> <span class="dv">50</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">                  )</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">pb<span class="op">$</span><span class="kw">init</span>()</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">pb<span class="op">$</span>title</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; Test progress bar (00:00:02)</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10">pb<span class="op">$</span>label</a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; 50/100(50%) completed.</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12">pb<span class="op">$</span><span class="kw">term</span>()</a></code></pre></div>
<div id="adding-bindings" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-bindings" class="anchor"></a>Adding Bindings</h2>
<p>In addition to those provided, additional bindings can be added to show even more information.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">words &lt;-<span class="st"> </span>stringi<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/stringi/man/stri_rand_lipsum.html">stri_rand_lipsum</a></span>(<span class="dv">1</span>, <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">         </span>stringi<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/stringi/man/stri_split.html">stri_split</a></span>(<span class="dt">fixed =</span> <span class="st">' '</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">         </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>()</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">pb &lt;-<span class="st"> </span>R6_progress<span class="op">$</span><span class="kw">new</span>( <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(words)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">                     , <span class="dt">title =</span> <span class="st">"Test Progress {current}/{total}"</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">                     , <span class="dt">label =</span> <span class="st">"Working on item {current}, {word}"</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">                     , <span class="dt">bindings =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">word =</span> <span class="op">~</span>words[pb<span class="op">$</span>current<span class="op">+</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">                     )</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">pb<span class="op">$</span><span class="kw">init</span>()</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">pb<span class="op">$</span>label</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; Working on item 0, Maecenas</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12">pb<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/stats/step.html">step</a></span>()</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">pb<span class="op">$</span>label</a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; Working on item 1, ac</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15">pb<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/stats/step.html">step</a></span>()</a>
<a class="sourceLine" id="cb7-16" data-line-number="16">pb<span class="op">$</span>label</a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; Working on item 2, eget</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18">pb<span class="op">$</span><span class="kw">term</span>()</a></code></pre></div>
</div>
</div>
<div id="class-system" class="section level1">
<h1 class="hasAnchor">
<a href="#class-system" class="anchor"></a>Class System</h1>
<p>Additional progress bars may be defined to work within the <code>purrrogress</code> framework, however each must inherit from the base progress class, “R6 Progress Base Class” which handles the creation and management of the active bindings for titles and labels.</p>
<div id="public-methods-to-implement-" class="section level4">
<h4 class="hasAnchor">
<a href="#public-methods-to-implement-" class="anchor"></a>Public Methods to Implement.</h4>
<p>The following are public methods for which a derived class <strong>must</strong> implement.</p>
<ul>
<li>
<strong><code>init()</code></strong> - This is called at the beginning of a loop or apply function. It should contain the code to actually create and show the progress bar window. Variables that are used to monitor and control the progress windows through other steps should be initialized here. It should additionally call <code>super$init()</code> to start timers. The return value should be <code><a href="https://rdrr.io/r/base/invisible.html">invisible(self)</a></code>.</li>
<li>
<strong><code>term()</code></strong> - This is called to close any open windows, close connections and free resources. After <code>term()</code> is called the progress object should be unusable. There is no need to call <code>super$term()</code> at this time but is it provided for good practice. The return value is expected to be <code><a href="https://rdrr.io/r/base/invisible.html">invisible(NULL)</a></code>.</li>
<li>
<strong><code><a href="https://rdrr.io/r/stats/update.html">update(...)</a></code></strong> - This takes any number of arguments which may be used to update internal variables or displays. This should handle updating of the progress window, titles, labels, etc. The return value is expected to be <code><a href="https://rdrr.io/r/base/invisible.html">invisible(self)</a></code>.</li>
</ul>
</div>
<div id="other-public-methods" class="section level4">
<h4 class="hasAnchor">
<a href="#other-public-methods" class="anchor"></a>Other Public Methods</h4>
<p>The following are functions that are provided in the public interface for R6 progress bars but do not need to be implemented in child classes, or when implemented care should be taken to carry forward the default behavior.</p>
<ul>
<li>
<strong><code><a href="https://rdrr.io/r/stats/step.html">step(n=1L, ..., keep.open=FALSE)</a></code></strong> - This is called to increment the internal progress counter, it in turn calls <code><a href="https://rdrr.io/r/stats/update.html">update(...)</a></code> function the update any windows, titles and labels. The <code>n</code> argument is provided to allow for taking uneven steps. The <code>keep.open</code> argument is provided to allow for windows that stay open to show relevant information, such as total time or average time per step. If <code>keep.open</code> is false (default) when the current counter reaches the total <code>term()</code> will be called.</li>
<li>
<strong><code>initialize(...)</code></strong> - populates the initial values of <code>title</code>, <code>label</code>, and <code>initial</code> count, which cannot be changed once specified.</li>
<li>
<strong><code>add_binding()</code></strong> - adds an active binding which may be used in the title or label.</li>
<li>
<strong><code>add_bindings(...)</code></strong> - a more convenient way to specify multiple bindings at once in the form of <code>add_bindings(name=funtion(){...})</code>.</li>
<li>
<strong><code>expose(sym)</code></strong> - The most convenient way of binding variable to use in the title or label. When called the variable from the current scope is added to the available bindings so that it may be referenced in the title or label.</li>
</ul>
</div>
</div>
<div id="acknowledgements" class="section level1">
<h1 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h1>
<p>This project was inspired by a post to <a href="https://www.r-bloggers.com/purrring-progress-bars-adding-a-progress-bar-to-purrrmap/">R-Bloggers</a> by Adi Sarid. Credit goes to him for the original idea on which <code>purrrogress</code> is built.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=purrrogress">https://​cloud.r-project.org/​package=purrrogress</a>
</li>
<li>Browse source code at <br><a href="https://github.com/halpo/purrrogress">https://​github.com/​halpo/​purrrogress</a>
</li>
<li>Report a bug at <br><a href="https://github.com/halpo/purrrogress/issues">https://​github.com/​halpo/​purrrogress/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Andrew Redd <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-6149-2438" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/halpo/purrrogress"><img src="https://travis-ci.org/halpo/purrrogress.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://codecov.io/gh/halpo/purrrogress?branch=master"><img src="https://codecov.io/gh/halpo/purrrogress/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Andrew Redd.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
